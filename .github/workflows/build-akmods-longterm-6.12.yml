---
#
# WARNING THIS IS A GENERATED WORKFLOW. DO NOT EDIT BY HAND!
#
# Generate the workflow by running `just generate-workflows` at git root
# Modify the inputs in workflow-templates
name: Build LONGTERM-6.12 akmods
on:
  merge_group:
  pull_request:
    branches:
      - main
    paths-ignore:
      - '**.md'
  schedule:
    - cron: '23 0 * * *'  # 0023 UTC everyday
  workflow_dispatch:
jobs:
  cache_kernel_longterm-6-12_42:
    name: Cache longterm-6.12 (42)
    uses: ./.github/workflows/reusable-cache-kernel.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    with:
      architecture: '["aarch64","x86_64"]'
      kernel_flavor: longterm-6.12
      version: 42
  build-longterm-6-12_42_common:
    name: Build common longterm-6.12 (42)
    uses: ./.github/workflows/reusable-build.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    needs: cache_kernel_longterm-6-12_42
    with:
      akmods_target: common
      architecture: '["aarch64","x86_64"]'
      kernel_cache_key: ${{ needs.cache_kernel_longterm-6-12_42.outputs.KCKEY }}
      kernel_flavor: longterm-6.12
      version: 42
  build-longterm-6-12_42_nvidia:
    name: Build nvidia longterm-6.12 (42)
    uses: ./.github/workflows/reusable-build.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    needs: cache_kernel_longterm-6-12_42
    with:
      akmods_target: nvidia
      architecture: '["aarch64","x86_64"]'
      kernel_cache_key: ${{ needs.cache_kernel_longterm-6-12_42.outputs.KCKEY }}
      kernel_flavor: longterm-6.12
      version: 42
  build-longterm-6-12_42_nvidia-open:
    name: Build nvidia-open longterm-6.12 (42)
    uses: ./.github/workflows/reusable-build.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    needs: cache_kernel_longterm-6-12_42
    with:
      akmods_target: nvidia-open
      architecture: '["aarch64","x86_64"]'
      kernel_cache_key: ${{ needs.cache_kernel_longterm-6-12_42.outputs.KCKEY }}
      kernel_flavor: longterm-6.12
      version: 42
  build-longterm-6-12_42_zfs:
    name: Build zfs longterm-6.12 (42)
    uses: ./.github/workflows/reusable-build.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    needs: cache_kernel_longterm-6-12_42
    with:
      akmods_target: zfs
      architecture: '["aarch64","x86_64"]'
      kernel_cache_key: ${{ needs.cache_kernel_longterm-6-12_42.outputs.KCKEY }}
      kernel_flavor: longterm-6.12
      version: 42
  check-longterm-6-12_42:
    name: Check longterm-6.12 (42)
    permissions:
      actions: read
      contents: read
    needs: [build-longterm-6-12_42_common,build-longterm-6-12_42_nvidia,build-longterm-6-12_42_nvidia-open,build-longterm-6-12_42_zfs]
    runs-on: ubuntu-24.04
    if: always()
    steps:
      - name: Check for Build Failures
        if: contains(needs.*.result, 'failure') || contains(needs.*.result, 'cancelled') || contains(needs.*.result, 'skipped')
        run: exit 1

      - name: Exit if Success
        run: exit 0
  cache_kernel_longterm-6-12_43:
    name: Cache longterm-6.12 (43)
    uses: ./.github/workflows/reusable-cache-kernel.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    with:
      architecture: '["aarch64","x86_64"]'
      kernel_flavor: longterm-6.12
      version: 43
  build-longterm-6-12_43_common:
    name: Build common longterm-6.12 (43)
    uses: ./.github/workflows/reusable-build.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    needs: cache_kernel_longterm-6-12_43
    with:
      akmods_target: common
      architecture: '["aarch64","x86_64"]'
      kernel_cache_key: ${{ needs.cache_kernel_longterm-6-12_43.outputs.KCKEY }}
      kernel_flavor: longterm-6.12
      version: 43
  build-longterm-6-12_43_nvidia:
    name: Build nvidia longterm-6.12 (43)
    uses: ./.github/workflows/reusable-build.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    needs: cache_kernel_longterm-6-12_43
    with:
      akmods_target: nvidia
      architecture: '["aarch64","x86_64"]'
      kernel_cache_key: ${{ needs.cache_kernel_longterm-6-12_43.outputs.KCKEY }}
      kernel_flavor: longterm-6.12
      version: 43
  build-longterm-6-12_43_nvidia-open:
    name: Build nvidia-open longterm-6.12 (43)
    uses: ./.github/workflows/reusable-build.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    needs: cache_kernel_longterm-6-12_43
    with:
      akmods_target: nvidia-open
      architecture: '["aarch64","x86_64"]'
      kernel_cache_key: ${{ needs.cache_kernel_longterm-6-12_43.outputs.KCKEY }}
      kernel_flavor: longterm-6.12
      version: 43
  build-longterm-6-12_43_zfs:
    name: Build zfs longterm-6.12 (43)
    uses: ./.github/workflows/reusable-build.yml
    secrets: inherit
    permissions:
      actions: read
      contents: read
      packages: write
    needs: cache_kernel_longterm-6-12_43
    with:
      akmods_target: zfs
      architecture: '["aarch64","x86_64"]'
      kernel_cache_key: ${{ needs.cache_kernel_longterm-6-12_43.outputs.KCKEY }}
      kernel_flavor: longterm-6.12
      version: 43
  check-longterm-6-12_43:
    name: Check longterm-6.12 (43)
    permissions:
      actions: read
      contents: read
    needs: [build-longterm-6-12_43_common,build-longterm-6-12_43_nvidia,build-longterm-6-12_43_nvidia-open,build-longterm-6-12_43_zfs]
    runs-on: ubuntu-24.04
    if: always()
    steps:
      - name: Check for Build Failures
        if: contains(needs.*.result, 'failure') || contains(needs.*.result, 'cancelled') || contains(needs.*.result, 'skipped')
        run: exit 1

      - name: Exit if Success
        run: exit 0
